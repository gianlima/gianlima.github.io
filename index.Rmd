---
title: "Pacote exams"
author: "Gian Lima"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

  Essa p?gina tem como objetivo criar tutoriais em portugu?s para o pacote _Exams_. O pacote permite a gera??o autom?tica de exames baseado em quest?es no formato _Markdown_ ou _LaTeX_, possibilitando incluir c?digo R para gera??o din?mica de elementos de quest?es.
  
  Ap?s a cria??o das quest?es, o examinando escolhe quais quest?es quer utilizar para formar o exame. Os formatos de sa?da dos exames podem ser em PDF, HTML, Docx, entre outros. As provas podem ser aplicadas de forma escrita ou online. 


## Tutoriais {.tabset .tabset-fade .tabset-pills}

### Info
<h3>Informa??es iniciais</h3>

1. Com o pacote exams ? poss?vel criar o mesmo exame:
<br><br>
      - com ordem aleat?ria das alternativas. Cada examinando receber? uma prova com a ordem das alternativas de forma aleat?ria. 
      - com v?rias alternativas, por?m escolhendo a quantidade que ir? aparecer. 
      *Exemplo*: o examinador cria 7 alternativas da mesma quest?o, por?m o examinando quer que seja mostrado apenas 4 delas. Dessa forma o pacote exams escolhe aleatoriamente 3 alternativas erradas + alternativa correta.
      - sendo a resposta correta variando conforme vari?veis num?ricas da quest?o sendo geradas aleatoriamente. ? poss?vel que todas as respostas certas sejam valores diferentes.
<br><br>
2. Torna-se mais dif?cil a possibilidade de trapacear no teste devido os motivos apresentados no t?pico 1. 

3. Os exames s?o corrigidos automaticamente da seguinte forma:
      - exames s?o gerados, impressos e entregues aos alunos
      - os alunos preenchem a folha resposta e entregam ao examinando
      - as folhas resposta s?o escaneadas e lidas pelo pacote
      - o resultado final com a pontua??o dos examinandos ? gerado automaticamente

### Primeiros Passos 

<h3>Olhada inicial: instala??o e quest?es prontas </h3>

1. Ser? necess?rio ter instalado:
    - Software R;
    - Sistema tipogr?fico LaTeX;
    - IDE para utilizar o R, por exemplo o RStudio;
    - Conversor de documentos Pandoc, j? vem instalado no RStudio.
    
2. Instalar o pacote exams e ativ?-lo

```{r eval = FALSE}
install.packages("exams", dependencies = TRUE)
library("exams") # ativar pacote 
```

3. Criar pasta para receber arquivos. No meu caso, criei uma pasta chamada "exames"

4. Indicar o caminho onde se encontra o diret?rio que ser? utilizado

```{r eval = FALSE }
setwd("C:/Users/Eloi/Desktop/exames") # salvei a pasta exames no desktop
```

5. Importar arquivos/exerc?cios j? prontos do pacote "exams"

```{r eval = FALSE}
exams_skeleton(markup = "markdown", encoding = "UTF-8",
  writer = c("exams2html", "exams2pdf", "exams2moodle"))
```

6. Foram criados dentro do diret?rio:
    - pasta _exercises_ contendo 31 exerc?cios em formato Rmarkdown 
    - pasta _template_ com modelos em formato LaTeX
    - 4 arquivos formato R demonstrando como criar exames nos formatos HTML, Moodle e PDF
    
```{r eval = FALSE}
dir() # verificar o que h? no diret?rio
```

7. Utilizar o exerc?cio **Swiss Capital** (capital da Su??a) para visualizar a quest?o em PDF e HTML. Os arquivos n?o s?o salvos, apenas renderizados.

```{r eval = FALSE}
exams2html("exercises/swisscapital.Rmd") # gera quest?o em HTML
exams2pdf("exercises/swisscapital.Rmd") # gera quest?o em PDF
```

8. Tamb?m ? poss?vel abrir com outros templates:
    - _exam.tex_, com problema, solu??o e folha de resposta *n?o preenchida*
    - _plain.tex_, apenas problema e solu??o
    - _solution.tex_, com problema, solu??o e folha de resposta *preenchida*

```{r eval = FALSE}
setwd("exercises") # utilizar diret?rio 'exercises'
exams2pdf("swisscapital.Rmd",
          template = "../templates/exam.tex")
exams2pdf("swisscapital.Rmd",
          template = "../templates/plain.tex")
exams2pdf("swisscapital.Rmd",
          template = "../templates/solution.tex")
```


9. Abrir o arquivo _swisscapital.Rmd_ para ver como foi editado. Lembre-se que est? saldo dentro da pasta _exercises_

```{r eval = FALSE}
file.edit('swisscapital.Rmd')
```

### Exame escrito

<h3>Criando exames na pr?tica com quest?es prontas </h3>

<div class="panel panel-primary">
  <div class="panel-heading">Aten??o</div>
  <div class="panel-body">
Se voc? acabou de ver a aba _Primeiros Passos_, apenas d? continuidade.
Caso n?o tenha visto os _Primeiros Passos_, confira os passos de 1 a 5 antes de dar in?cio a esse tutorial.
  </div>
</div>

1. Criar quest?es:
    - Aleat?rias formando um banco de quest?es
    - Quest?es espec?ficas para um determinado exame

```
Neste tutorial ser? utilizado quest?es j? prontas do pacote. Para aprender como montar as quest?es, confira a aba XXX.
```

2. Selecionar quest?es que ser?o utilizadas no exame. Neste caso montaremos com 6 quest?es. Retornar ao diret?rio _exames_

```{r eval = FALSE}
setwd("C:/Users/Eloi/Desktop/exames")
exame <- list(
  "tstat2.Rnw",
  "ttest.Rnw",
  "relfreq.Rnw",
  "anova.Rnw",
  c("boxplots.Rnw", "scatterplot.Rnw"),
  "cholesky.Rnw"
)
```

3. Precisamos indicar:
      - lista de exerc?cios (chamamos a lista de _exame_ anteriormente)
      - quantos exames precisamos (_n_)
      - a pontua??o de cada exerc?cio (_points_)
      - em qual pasta os exames ficar?o salvos, a pasta ser? criada automaticamente (_dir_)
      - nome dos exames (_name_)
      - data (_date_)
      - mostrar os pontos na prova (_showpoints_)

```{r eval = FALSE}
set.seed(403) # semente aleat?ria da demonstra??o
ex1 <- exams2nops(exame, n = 2,
                  dir = "nops_pdf", name = "demo", date = "2015-07-29",
                  points = c(1, 1, 1, 2, 2, 3), showpoints = TRUE)
```

* Perceba que foi criado uma pasta chamada _nops_pdf_ que cont?m 3 arquivos:
      - 2 exames: _demo1_ e _demo2_
      - arquivo _demo.rds_ onde cont?m informa??es sobre os exames criados
<br><br>
* Nos exames em PDF _demo1_ e _demo2_, j? cont?m:
      - folha de resposta 
      - 1 folha em branco caso seja impresso frente em verso a folha resposta. Caso n?o deseje, insira o argumento _duplex = FALSE_
      - 6 quest?es sem solu??o
      - folhas de rascunho
<br><br> 
* Argumentos para adicionar na fun??o `exams2nops()` para personalizar:
      - `institution`: nome da institui??o
      - `title` : t?tulo do exame
      - `language` : trocar idioma, `language = "pt"` para portugu?s
4. Imprimir os arquivos gerados

```
? recomendado imprimir com o clipe do lado esquerdo no topo, e N?O escolher a op??o "Ajustar a ?rea imprim?vel".
```

5. Criar arquivo com o registro (possivelmente matr?cula), nome e id de cada examinando. Arquivo precisa estar no formato .csv, pode ser gerado num editor de planilhas. C?digo abaixo representa uma demonstra??o de planilha criada dentro do R

```{r eval = FALSE}
write.table(data.frame(
  registration = c("1501090", "9901071"),
  name = c("Jane Doe", "Ambi Dexter"),
  id = c("jane_doe", "ambi_dexter")
), file = "Exam-2015-07-29.csv", sep = ";", quote = FALSE, row.names = FALSE)
```

* Observe que ? necess?rio utilizar os argumentos:
      - `registration`: registro de cada examinando contendo 7 n?meros
      - `name`: nome de cada examinando
      - `id`: identifica??o de cada examinando
      - `file`: nome do arquivo _.csv_ que ser? criado

6. Aplicar os exames impressos

* Campos de preenchimento dispon?vels nos exames:
      - Dados pessoais: sobrenome, nome e assinatura (_n?o obrigat?rios_)
      - N?mero de registro: os mesmos colocados no arquivo _.csv_ (obrigat?rio)
      - Respostas das quest?es (_n?o obrigat?rio_)

<div class="panel panel-primary">
  <div class="panel-heading">Aten??o!</div>
  <div class="panel-body">
<i>Campo obrigat?rio</i>: ocorrer? erro na leitura dos exames se n?o for preenchido ou se for preenchido de forma incorreta <br><br>
<i>Campo n?o obrigat?rio</i>: n?o interfere na efic?cia da leitura dos exames 
<br><br>
<p class="text-danger">Cada aluno dever? ter um <i>n?mero de registro</i> diferente dos demais.</p>
  </div>
</div>

7. Escanear folha de resposta

 Os examinandos devem destacar a _folha resposta_ e entregar ao examinador. O examinador, por sua vez, deve escanear a folha. A imagem escaneada deve ser no formato PNG, caso esteja em outro formato pode ser transformada com outro pacote:

```{r eval = FALSE}
install.packages("magick")  # instalar pacote Magick
library(magick) # carregar pacote
exame1 <- image_read('path onde se encontra a imagem escaneada') # carregar imagem dentro do software
image_write(exame1, path = "exame1.png", format = "png") # trocar formato e salvar
```

Por motivos de demonstra??o, utilizamos 2 folhas j? impressas, preenchidas e escaneadas dispon?veis no pacote e que nos servir?o de exemplo:

```{r eval = FALSE}
img <- dir(system.file("nops", package = "exams"), pattern = "nops_scan",
  full.names = TRUE) # localizar imagens j? processadas
dir.create("nops_scan") # criar pasta nops_scan
file.copy(img, to = "nops_scan") # inserir imagens dentro da pasta
```
* Observe dentro da pasta exames:
      - a pasta _nops_scan_ foi criada
      - 2 _folhas de resposta_ em formato PNG foram inseridas dentro da pasta _nops_scan_
      
8. Importar folha de resposta para que o software leia os dados

```{r eval = FALSE}
nops_scan(dir = "nops_scan") # leitura das imagens dentro da pasta nops_scan
```

* Note que dentro da pasta _nops_scan_ um novo arquivo ZIP foi gerado contendo as 2 imagens escaneadas e um arquivo _Daten.txt_ contendo:
      - nome do arquivo das imagens escaneadas;
      - Exame ID;
      - N?mero de registro;
      - resposta de cada quest?o
      
      
<div class="panel panel-warning">
<div class="panel-heading">Observa??es</div>
<div class="panel-body">
* Se houve problema na hora de criar o arquivo ZIP (_error status 127_), h? uma possibilidade de solu??o a ser testada:
      - Instalar Rtools nesse [link](https://cran.r-project.org/bin/windows/Rtools/)
      - Localizar onde o arquivo foi instalado, provavelmente `C:\Rtools`
      - Adicionar `C:\Rtools\bin` no caminho do sistema em _Vari?veis do ambiente_. Caso n?o saiba onde encontrar isso, ? facilmente encontrado no _google._
      - Dentro da vari?vel _PATH_ adicionar o texto `;C:\Rtools\bin`
</div>
</div>


9. O pacote ir? comparar os dados da _folha de resposta_ dos examinandos (_Daten.txt_) com as respostas corretas geradas pelo examinador durante a cria??o das quest?es (_demo.rds_)

```{r eval = FALSE}
ev1 <- nops_eval(
  register = "Exam-2015-07-29.csv",
  solutions = "nops_pdf/demo.rds",
  scans = Sys.glob("nops_scan/nops_scan_*.zip"),
  eval = exams_eval(partial = FALSE, negative = FALSE),
  interactive = FALSE
)
dir() # perceba que foram adicionados 2 arquivos
```

* Note que foram passados como argumentos alter?veis principais:
      - `register`: nome da planilha criada no passo 5 (_character_ do argumento `file`)
      - `solutions`: caminho onde est? salvo o arquivo RDS quando foi criado os exames passo 3 

* Adicionados os arquivos _nops_eval.csv_ e _nops_eval.zip_ contendo p?gina HTML com:
      - nome do examinando
      - n?mero de registro
      - pontos obtidos em cada quest?o
      - quest?es certas e erradas




### Exame online 

1. Criar passo-a-passo ainda
 








 

